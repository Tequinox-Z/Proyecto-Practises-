"use strict";(self.webpackChunkPractises_Management=self.webpackChunkPractises_Management||[]).push([[743],{2743:(Y,_,o)=>{o.r(_),o.d(_,{PractiseModule:()=>B});var u=o(9808),d=o(1451),g=o(5226),c=o.n(g),t=o(1223),l=o(2340),m=o(3958),h=o(5295),f=o(520);let v=(()=>{class n{constructor(e,i,r){this.userService=e,this.authService=i,this.http=r}getEnrollment(e){return this.http.get(l.N.serverAddress+"/enrollment/"+e,this.authService.getHeadersToken())}startPractise(e){return this.http.post(l.N.serverAddress+"/enrollment/"+e+"/practise",{},this.authService.getHeadersToken())}updatePractise(e){return this.http.put(l.N.serverAddress+"/practise/"+e.id,e,this.authService.getHeadersToken())}setBusiness(e,i){let r={};return r.cif=e,this.http.post(l.N.serverAddress+"/practise/"+i+"/business",r,this.authService.getHeadersToken())}editBusiness(e,i){let r={};return r.cif=e,this.http.put(l.N.serverAddress+"/practise/"+i+"/business",r,this.authService.getHeadersToken())}getBusiness(e){return this.http.get(l.N.serverAddress+"/practise/"+e+"/business",this.authService.getHeadersToken())}getTeacher(e){return this.http.get(l.N.serverAddress+"/practise/"+e+"/teacher",this.authService.getHeadersToken())}getTutor(e){return this.http.get(l.N.serverAddress+"/practise/"+e+"/labor-tutor",this.authService.getHeadersToken())}editTutor(e,i){let r={};return r.dni=i,this.http.put(l.N.serverAddress+"/practise/"+e.id+"/labor-tutor",r,this.authService.getHeadersToken())}editTeacher(e,i){let r={};return r.dni=i,this.http.put(l.N.serverAddress+"/practise/"+e.id+"/teacher",r,this.authService.getHeadersToken())}quitLaborTutor(e){return this.http.delete(l.N.serverAddress+"/practise/"+e.id+"/labor-tutor",this.authService.getHeadersToken())}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(m.K),t.LFG(h.e),t.LFG(f.eN))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var x=o(2864),T=o(2360),P=o(1447);function C(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"div",3),t.NdJ("click",function(){const a=t.CHM(e).$implicit;return t.oxw().select(a.dni)}),t._UZ(1,"img",4),t.TgZ(2,"p"),t._uU(3),t.qZA(),t.qZA()}if(2&n){const e=s.$implicit;t.xp6(1),t.s9C("src",e.image,t.LSH),t.xp6(2),t.Oqu(e.name)}}let b=(()=>{class n{constructor(e){this.laborService=e,this.dni=new t.vpe,this.cif=""}ngOnInit(){this.laborService.getTutors(this.cif).subscribe({next:e=>{this.tutors=e},error:e=>{c().fire({icon:"error",title:"Oops...",text:e.error.mensaje})}})}select(e){this.dni.emit(e)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(P.U))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-select-tutor"]],inputs:{cif:"cif"},outputs:{dni:"dni"},decls:5,vars:1,consts:[["id","businessDiv"],["id","businessDivs"],["class","business",3,"click",4,"ngFor","ngForOf"],[1,"business",3,"click"],[3,"src"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"p"),t._uU(2,"Seleccione tutor"),t.qZA(),t.TgZ(3,"div",1),t.YNc(4,C,4,2,"div",2),t.qZA(),t.qZA()),2&e&&(t.xp6(4),t.Q6J("ngForOf",i.tutors))},directives:[u.sg],styles:["#businessDiv[_ngcontent-%COMP%] > p[_ngcontent-%COMP%]:nth-child(1){font-size:20px;margin-top:29px;margin-left:30px}#businessDiv[_ngcontent-%COMP%]{height:94%}#businessDivs[_ngcontent-%COMP%]{margin-top:10px;height:92%;overflow:auto}.business[_ngcontent-%COMP%]{height:66px;width:100%;display:flex;flex-direction:row;flex-wrap:wrap;align-content:center;align-items:center;transition:.2s;padding-left:12%}.business[_ngcontent-%COMP%]:hover{background-color:#dfdfdf}.business[_ngcontent-%COMP%] > p[_ngcontent-%COMP%]:nth-child(2){margin-left:20px}.business[_ngcontent-%COMP%] > img[_ngcontent-%COMP%]:nth-child(1){width:56px;height:39px}"]}),n})();function Z(n,s){1&n&&(t.TgZ(0,"div",8),t._UZ(1,"p",9),t.TgZ(2,"p"),t._uU(3,"D\xedas restantes"),t.qZA(),t.qZA())}function M(n,s){1&n&&(t.TgZ(0,"p"),t._uU(1,"Pulse en comenzar para iniciar las pr\xe1cticas del alumno"),t.qZA())}function w(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"button",14),t.NdJ("click",function(){return t.CHM(e),t.oxw(3).startPractise()}),t._uU(1,"Comenzar"),t.qZA()}}function O(n,s){if(1&n&&(t.TgZ(0,"div",10),t._UZ(1,"img",11),t.TgZ(2,"p"),t._uU(3,"Pr\xe1cticas no comenzadas"),t.qZA(),t.YNc(4,M,2,0,"p",12),t.YNc(5,w,2,0,"button",13),t.qZA()),2&n){const e=t.oxw(2);t.xp6(4),t.Q6J("ngIf",e.isAdmin),t.xp6(1),t.Q6J("ngIf",e.isAdmin)}}function E(n,s){1&n&&t._UZ(0,"img",26)}function A(n,s){1&n&&t._UZ(0,"img",26)}function S(n,s){1&n&&t._UZ(0,"img",26)}function N(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"img",27),t.NdJ("click",function(){return t.CHM(e),t.oxw(3).setDateStart()}),t.qZA()}}function y(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"img",27),t.NdJ("click",function(){return t.CHM(e),t.oxw(3).setDateEnd()}),t.qZA()}}function I(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"div",15),t.TgZ(1,"p",16),t._uU(2,"Pr\xe1cticas del alumno"),t.qZA(),t.TgZ(3,"div",17),t._UZ(4,"img",18),t.TgZ(5,"p"),t._uU(6,"Empresa"),t.qZA(),t.TgZ(7,"p",14),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(2);return!!r.isAdmin&&(r.selectBusiness=!0)}),t._uU(8),t.YNc(9,E,1,0,"img",19),t.qZA(),t.qZA(),t.TgZ(10,"div",20),t._UZ(11,"img",21),t.TgZ(12,"p"),t._uU(13,"Tutor laboral"),t.qZA(),t.TgZ(14,"p",14),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(2);return!!r.isAdmin&&r.selectNewTutor()}),t._uU(15),t.YNc(16,A,1,0,"img",19),t.qZA(),t.qZA(),t.TgZ(17,"div",22),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(2);return!!r.isAdmin&&(r.selectTeacher=!0)}),t._UZ(18,"img",21),t.TgZ(19,"p"),t._uU(20,"Profesor de pr\xe1cticas"),t.qZA(),t.TgZ(21,"p"),t._uU(22),t.YNc(23,S,1,0,"img",19),t.qZA(),t.qZA(),t.TgZ(24,"div",23),t.TgZ(25,"p"),t._uU(26,"Fecha inicio"),t.qZA(),t.TgZ(27,"p"),t._uU(28),t.qZA(),t.YNc(29,N,1,0,"img",24),t.qZA(),t.TgZ(30,"div",25),t.TgZ(31,"p"),t._uU(32,"Fecha fin"),t.qZA(),t.TgZ(33,"p"),t._uU(34),t.qZA(),t.YNc(35,y,1,0,"img",24),t.qZA(),t.qZA()}if(2&n){const e=t.oxw(2);t.xp6(8),t.hij("",e.currentEnrollment.practise.business?e.currentEnrollment.practise.business.name:"No establecido"," "),t.xp6(1),t.Q6J("ngIf",e.isAdmin),t.xp6(6),t.Oqu(e.currentEnrollment.practise.laborTutor?e.currentEnrollment.practise.laborTutor.name:"No establecido"),t.xp6(1),t.Q6J("ngIf",e.isAdmin),t.xp6(6),t.Oqu(e.currentEnrollment.practise.teacher?e.currentEnrollment.practise.teacher.name:"No establecido"),t.xp6(1),t.Q6J("ngIf",e.isAdmin),t.xp6(5),t.Oqu(e.currentEnrollment.practise.start?e.currentEnrollment.practise.start.toString().slice(0,10):" No establecido "),t.xp6(1),t.Q6J("ngIf",e.isAdmin),t.xp6(5),t.Oqu(e.currentEnrollment.practise.finish?e.currentEnrollment.practise.finish.toString().slice(0,10):" No establecido "),t.xp6(1),t.Q6J("ngIf",e.isAdmin)}}function D(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"app-select-business",32),t.NdJ("cif",function(r){return t.CHM(e),t.oxw(3).setBusiness(r)}),t.qZA()}}function q(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"app-select-teacher",33),t.NdJ("dni",function(r){return t.CHM(e),t.oxw(3).setTeacher(r)}),t.qZA()}}function k(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"app-select-tutor",34),t.NdJ("dni",function(r){return t.CHM(e),t.oxw(3).setTutor(r)})("dni",function(r){return t.CHM(e),t.oxw(3).setTutor(r)}),t.qZA()}if(2&n){const e=t.oxw(3);t.Q6J("cif",e.currentEnrollment.practise.business.cif)}}function V(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"div",28),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).closeAll()}),t.YNc(1,D,1,0,"app-select-business",29),t.YNc(2,q,1,0,"app-select-teacher",30),t.YNc(3,k,1,1,"app-select-tutor",31),t.qZA()}if(2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",e.selectBusiness),t.xp6(1),t.Q6J("ngIf",e.selectTeacher),t.xp6(1),t.Q6J("ngIf",e.selectTutor)}}function J(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"div",1),t.TgZ(1,"div",2),t.TgZ(2,"p"),t.TgZ(3,"span",3),t.NdJ("click",function(){return t.CHM(e),t.oxw().back()}),t._uU(4,"Pr\xe1cticas > "),t.qZA(),t._uU(5),t.qZA(),t.qZA(),t.YNc(6,Z,4,0,"div",4),t.YNc(7,O,6,2,"div",5),t.YNc(8,I,36,10,"div",6),t.YNc(9,V,4,3,"div",7),t.qZA()}if(2&n){const e=t.oxw();t.xp6(5),t.AsE("",null==e.currentEnrollment.student?null:e.currentEnrollment.student.name," ",null==e.currentEnrollment.student?null:e.currentEnrollment.student.lastName,""),t.xp6(1),t.Q6J("ngIf",e.currentEnrollment.practise),t.xp6(1),t.Q6J("ngIf",!e.currentEnrollment.practise),t.xp6(1),t.Q6J("ngIf",e.currentEnrollment.practise),t.xp6(1),t.Q6J("ngIf",e.selectBusiness||e.selectTutor||e.selectTeacher)}}const U=[{path:"view/:idEnrollment",component:(()=>{class n{constructor(e,i,r){this.practiseSrv=e,this.rutaActiva=i,this.userSrv=r,this.selectBusiness=!1,this.selectTutor=!1,this.selectTeacher=!1,this.isAdmin=!1}setBusiness(e){var i;(null===(i=this.currentEnrollment.practise)||void 0===i?void 0:i.business)?this.practiseSrv.editBusiness(e,this.currentEnrollment.practise.id).subscribe({next:r=>{this.practiseSrv.quitLaborTutor(this.currentEnrollment.practise).subscribe({next:()=>{this.loadEnrollment()},error:()=>{this.loadEnrollment()}})},error:r=>{c().fire({icon:"error",title:"Oops...",text:r.error.mensaje})}}):this.practiseSrv.setBusiness(e,this.currentEnrollment.practise.id).subscribe({next:r=>{this.practiseSrv.quitLaborTutor(this.currentEnrollment.practise).subscribe({next:()=>{this.loadEnrollment()},error:a=>{this.loadEnrollment()}})},error:r=>{c().fire({icon:"error",title:"Oops...",text:r.error.mensaje})}})}setTeacher(e){this.practiseSrv.editTeacher(this.currentEnrollment.practise,e).subscribe({next:()=>{this.loadEnrollment()},error:i=>{c().fire({icon:"error",title:"Oops...",text:i.error.mensaje})}})}setTutor(e){this.practiseSrv.editTutor(this.currentEnrollment.practise,e).subscribe({next:()=>{this.loadEnrollment()},error:i=>{c().fire({icon:"error",title:"Oops...",text:i.error.mensaje})}})}selectNewTutor(){var e;(null===(e=this.currentEnrollment.practise)||void 0===e?void 0:e.business)?this.selectTutor=!0:c().fire({icon:"error",title:"Oops...",text:"Indique primero la empresa"})}closeAll(){this.selectBusiness=!1,this.selectTutor=!1,this.selectTeacher=!1}ngAfterViewInit(){setTimeout(()=>{this.setRestantDays()},100)}ngOnInit(){var e,i;"ROLE_ADMIN"==(null===(i=null===(e=this.userSrv.getPerson())||void 0===e?void 0:e.rol)||void 0===i?void 0:i.toString())&&(this.isAdmin=!0),this.loadEnrollment()}loadEnrollment(){this.practiseSrv.getEnrollment(this.rutaActiva.snapshot.params.idEnrollment).subscribe({next:i=>{this.currentEnrollment=i,this.getBusiness(this.currentEnrollment.practise.id),this.getTeacher(this.currentEnrollment.practise.id),this.getTutor(this.currentEnrollment.practise.id),this.setRestantDays()},error:i=>{c().fire({icon:"error",title:"Oops...",text:i.error.mensaje})}})}getBusiness(e){this.practiseSrv.getBusiness(e).subscribe({next:i=>{this.currentEnrollment.practise.business=i},error:i=>{c().fire({icon:"error",title:"Oops...",text:i.error.mensaje})}})}getTeacher(e){this.practiseSrv.getTeacher(e).subscribe({next:i=>{this.currentEnrollment.practise.teacher=i}})}getTutor(e){this.practiseSrv.getTutor(e).subscribe({next:i=>{this.currentEnrollment.practise.laborTutor=i}})}back(){history.go(-1)}startPractise(){this.practiseSrv.startPractise(this.rutaActiva.snapshot.params.idEnrollment).subscribe({next:i=>{this.loadEnrollment()},error:i=>{c().fire({icon:"error",title:"Oops...",text:i.error.mensaje})}})}setDateStart(){c().fire({title:"Indique fecha de inicio",html:'<input type="date" id="start" class="swal2-input" placeholder="Fecha inicio">',confirmButtonText:"Establecer",focusConfirm:!1,preConfirm:()=>{let e=c().getPopup().querySelector("#start");0!=e.value.trim().length&&this.configureStart(e.value)}})}setDateEnd(){c().fire({title:"Indique fecha de fin",html:'<input type="date" id="end" class="swal2-input" placeholder="Fecha fin">',confirmButtonText:"Establecer",focusConfirm:!1,preConfirm:()=>{let e=c().getPopup().querySelector("#end");0!=e.value.trim().length&&this.configureEnd(e.value)}})}configureEnd(e){this.practiseSrv.getEnrollment(this.rutaActiva.snapshot.params.idEnrollment).subscribe({next:r=>{let a=r;a.practise.finish=new Date(e),this.practiseSrv.updatePractise(a.practise).subscribe({next:p=>{this.loadEnrollment(),this.setRestantDays()},error:p=>{c().fire({icon:"error",title:"Oops...",text:p.error.mensaje})}})},error:r=>{c().fire({icon:"error",title:"Oops...",text:r.error.mensaje})}})}configureStart(e){this.practiseSrv.getEnrollment(this.rutaActiva.snapshot.params.idEnrollment).subscribe({next:r=>{let a=r;a.practise.start=new Date(e),this.practiseSrv.updatePractise(a.practise).subscribe({next:p=>{this.loadEnrollment(),this.setRestantDays()},error:p=>{c().fire({icon:"error",title:"Oops...",text:p.error.mensaje})}})},error:r=>{c().fire({icon:"error",title:"Oops...",text:r.error.mensaje})}})}setRestantDays(){let e=document.querySelector("#restant");e&&(e.innerText=this.calculateDiff())}calculateDiff(){var e;if((null===(e=this.currentEnrollment.practise)||void 0===e?void 0:e.start)&&this.currentEnrollment.practise.finish){let r=new Date(this.currentEnrollment.practise.finish).getTime()-(new Date).getTime();return r<0?"0":parseInt((r/864e5).toString()).toString()}return"0"}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(v),t.Y36(d.gz),t.Y36(m.K))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-view-practise"]],decls:1,vars:1,consts:[["id","mainDiv","class","inNewIntro",4,"ngIf"],["id","mainDiv",1,"inNewIntro"],["id","title"],["id","degreesText",3,"click"],["id","rest",4,"ngIf"],["id","noPractise",4,"ngIf"],["id","practiseDiv",4,"ngIf"],["id","modal-zone",3,"click",4,"ngIf"],["id","rest"],["id","restant"],["id","noPractise"],["src","assets/img/business.png","id","businessImg"],[4,"ngIf"],[3,"click",4,"ngIf"],[3,"click"],["id","practiseDiv"],["id","text-practise"],["id","topElement",1,"element"],["src","assets/img/business.png"],["class","editOption","src","assets/img/edit.png",4,"ngIf"],[1,"element"],["src","assets/img/teacherImg.png"],[1,"element",3,"click"],["id","startDate",1,"dateZone"],["src","assets/img/edit.png",3,"click",4,"ngIf"],["id","endDate",1,"dateZone"],["src","assets/img/edit.png",1,"editOption"],["src","assets/img/edit.png",3,"click"],["id","modal-zone",3,"click"],["class","selectModal",3,"cif",4,"ngIf"],["class","selectModal",3,"dni",4,"ngIf"],["class","selectModal",3,"cif","dni",4,"ngIf"],[1,"selectModal",3,"cif"],[1,"selectModal",3,"dni"],[1,"selectModal",3,"cif","dni"]],template:function(e,i){1&e&&t.YNc(0,J,10,6,"div",0),2&e&&t.Q6J("ngIf",i.currentEnrollment)},directives:[u.O5,x.B,T.A,b],styles:["#mainDiv[_ngcontent-%COMP%]{width:100%;height:100%;overflow:auto}#title[_ngcontent-%COMP%]{margin-top:40px;height:10%;width:100%}#title[_ngcontent-%COMP%] > p[_ngcontent-%COMP%]{padding-left:4%}#title[_ngcontent-%COMP%] > p[_ngcontent-%COMP%]:nth-child(1){font-size:20px;font-weight:600}#title[_ngcontent-%COMP%] > p[_ngcontent-%COMP%]:nth-child(2){opacity:.7}#degreesText[_ngcontent-%COMP%]{opacity:.7}#noPractise[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center;align-items:center;flex-direction:column;height:70%}#noPractise[_ngcontent-%COMP%] > p[_ngcontent-%COMP%]:nth-child(2){font-size:20px}#noPractise[_ngcontent-%COMP%] > p[_ngcontent-%COMP%]:nth-child(3){opacity:.7;max-width:315px;text-align:center;padding-top:5px}#businessImg[_ngcontent-%COMP%]{width:90%;max-width:186px}#noPractise[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{border:none;height:40px;margin-top:10px;width:120px}#practiseDiv[_ngcontent-%COMP%]{height:80%;position:relative;display:flex;flex-wrap:wrap;align-content:center;justify-content:center;align-items:flex-start}#text-practise[_ngcontent-%COMP%]{position:absolute;top:0px;font-size:20px;left:4%}#startDate[_ngcontent-%COMP%]{position:absolute;font-size:20px;bottom:2%;left:4%}#endDate[_ngcontent-%COMP%]{position:absolute;font-size:20px;bottom:2%;right:4%}.dateZone[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:row}.dateZone[_ngcontent-%COMP%] > img[_ngcontent-%COMP%]{width:15px}.dateZone[_ngcontent-%COMP%] > p[_ngcontent-%COMP%]:nth-child(2){font-size:initial;opacity:.7;margin-right:10px;margin-left:10px}.element[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex-wrap:wrap;align-content:center;position:relative;top:-50px;justify-content:center;width:33.3%;align-items:center}.element[_ngcontent-%COMP%] > img[_ngcontent-%COMP%]{height:159px}.element[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:nth-child(2){position:relative;top:20px}.element[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:nth-child(3){position:relative;top:25px;opacity:.7}#restantes[_ngcontent-%COMP%]{position:absolute;right:4%}@media (max-width: 600px){#practiseDiv[_ngcontent-%COMP%]{flex-direction:column;flex-wrap:nowrap;align-content:center!important;align-items:center!important}.dateZone[_ngcontent-%COMP%]{padding-bottom:15px}.element[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:nth-child(2){text-align:center}.element[_ngcontent-%COMP%]{margin-bottom:70px}#topElement[_ngcontent-%COMP%]{margin-top:569px}#startDate[_ngcontent-%COMP%], #endDate[_ngcontent-%COMP%]{position:initial}}#rest[_ngcontent-%COMP%]{position:absolute;top:61px;display:flex;right:4%;flex-direction:column;align-items:flex-end}#rest[_ngcontent-%COMP%] > p[_ngcontent-%COMP%]:nth-child(1){font-size:25px}#rest[_ngcontent-%COMP%] > p[_ngcontent-%COMP%]:nth-child(2){opacity:.7}.editOption[_ngcontent-%COMP%]{width:15px;margin-left:5px}#modal-zone[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;display:flex;background-color:#00000072;justify-content:center;align-items:center;top:0}#modal-zone[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{height:461px;background-color:#fff;max-width:400px;width:90%;transition:1s;animation-name:introSlow;animation-duration:.2s}"]}),n})()}];let F=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[d.Bz.forChild(U)],d.Bz]}),n})();var H=o(4466);let B=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[u.ez,F,H.m]]}),n})()}}]);